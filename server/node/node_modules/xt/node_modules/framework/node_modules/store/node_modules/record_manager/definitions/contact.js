
// require some core modules
var UTIL    = require("util");
var PATH    = require("path");

// load into module namespace from above
require("tools");
require("exception");
require("store");

// load into module namespace from level
require("record");

XT.Contact = XT.Record.extend({

  definition: {

    // sproutcore record equivalent
    sctype: "XT.Contact",

    // postgres table
    table: "cntct",

    // postgres schema
    schema: "public",

    // postgres sequence for guid/id
    sequence: "cntct_cntct_id_seq",

    // fields as columns
    fields: {
      
      //....................................
      // sproutcore fields

      guid:         "cntct_id",

      number:       "cntct_number",

      honorific:    "cntct_honorific",

      firstName:    "cntct_first_name",

      middleName:   "cntct_middle",

      lastName:     "cntct_last_name",

      suffix:       "cntct_suffix",

      jobTitle:     "cntct_title",

      initials:     "cntct_initials",

      isActive:     "cntct_active",

      phone:        "cntct_phone",

      alternate:    "cntct_phone2",

      fax:          "cntct_fax",

      webAddress:   "cntct_webaddr",

      notes:        "cntct_notes",

      owner:        "cntct_owner_username",

      primaryEmail: "cntct_email",

      crmAccount:   "cntct_crmacct_id",

      address:      "cntct_addr_id"

    },

    //....................................
    // toMany mappings

    toMany: {

      comments:     XT.Record.toMany({
        self:     "XT.Contact",
        relation: "XT.ContactComment",
        on:       "guid",
        to:       "source",
        static:   XT.Record.static({ "comment_source":"'T'" }),
      }),

      characteristics:  XT.Record.toMany({
        self:     "XT.Contact",
        relation: "XT.ContactCharacteristic",
        on:       "guid",
        to:       "target",
        static:   XT.Record.static({ "charass_target_type":"'CNTCT'" }),
      }),

      email:  XT.Record.toMany({
        self:     "XT.Contact",
        relation: "XT.ContactEmail",
        on:       "guid",
        to:       "contact"
      })

    }

  }, // definition

  /** @private */
  xtClass: "XT.Contact",

});

XT.Store.recordManager.emit("definitionLoaded", XT.Contact);


// require some core modules
var UTIL    = require("util");
var PATH    = require("path");

// load into module namespace from above
require("tools");
require("exception");
require("store");

// load into module namespace from level
require("record");

XT.Prospect = XT.Record.extend({

  definition: {

    // sproutcore record equivalent
    sctype: "XT.Prospect",

    // postgres table
    table: "prospect",

    // postgres schema
    schema: "public",

    // postgres sequence
    sequence: "cust_cust_id_seq",

    // fields as columns
    fields: {
      
      //....................................
      // sproutcore fields

      guid:             "prospect_id",
    
      number:           "prospect_number",

      name:             "prospect_name",

      active:           "prospect_active",

      notes:            "prospect_comments",

      contact:          "prospect_cntct_id",

      salesRep:         "prospect_salesrep_id",

      taxZone:          "prospect_taxzone_id",

      site:             "prospect_warehous_id"

    },
     
    //....................................
    // toMany mappings

    toMany: {
          
      // This is not really toMany, but a workable
      // way to get the crmAccount id
      crmAccount:     XT.Record.toMany({
                      self:     "XT.Prospect",
                      relation: "XT.CrmAccount",
                      on:       "guid",
                      to:       "prospect"
                    }),

      quotes:     XT.Record.toMany({
                      self:     "XT.Prospect",
                      relation: "XT.Quote",
                      on:       "guid",
                      to:       "customer"
                    })

    }

  }, // definition

  /** @private */
  xtClass: "XT.Prospect"

});

XT.Store.recordManager.emit("definitionLoaded", XT.Prospect);


// require some core modules
var UTIL    = require("util");
var PATH    = require("path");

// load into module namespace from above
require("tools");
require("exception");
require("store");

// load into module namespace from level
require("record");

XT.QuoteItem = XT.Record.extend({

  definition: {

    // sproutcore record equivalent
    sctype: "XT.QuoteItem",

    // postgres table
    table: "quitem",

    // postgres schema
    schema: "public",

    // postgres sequence for guid/id
    sequence: "quitem_quitem_id_seq",

    // fields as columns
    fields: {
      
      //....................................
      // sproutcore fields

      guid:               "quitem_id",

      quote:              "quitem_quhead_id",

      number:             "quitem_linenumber",

      item:               "quitem_item_id",

      site:               "quitem_order_warehous_id",

      itemSite:           "quitem_itemsite_id",

      qtyOrdered:         "quitem_qtyord",

      qtyUom:             "quitem_qty_uom_id",

      qtyUomRatio:        "quitem_qty_invuomratio",

      unitCost:           "quitem_unitcost",

      price:              "quitem_price",

      priceUom:           "quitem_price_uom_id",

      priceUomRatio:      "quitem_price_invuomratio",

      customerPrice:      "quitem_custprice",

      scheduleDate:       "quitem_scheddate",

      promiseDate:        "quitem_promdate",

      dropShip:           "quitem_dropship",

      isCreateWorkOrder:  "quitem_createorder",

      purchasePrice:      "quitem_prcost",

      notes:              "quitem_memo",

      taxType:            "quitem_taxtype_id",

      itemSource:         "quitem_itemsrc_id"

    },

    //....................................
    // toMany mappings
                              
    toMany: {

      comments:     XT.Record.toMany({
        self:     "XT.QuoteItem",
        relation: "XT.Comment",
        on:       "guid",
        to:       "source",
        static:   XT.Record.static({ "comment_source":"'QI'" }),
      }),

      characteristics:  XT.Record.toMany({
        self:     "XT.QuoteItem",
        relation: "XT.CharacteristicAssignment",
        on:       "guid",
        to:       "target",
        static:   XT.Record.static({ "charass_target_type":"'QI'" }),
      })

    },

  }, // definition

  /** @private */
  xtClass: "XT.QuoteItem"

});

XT.Store.recordManager.emit("definitionLoaded", XT.QuoteItem);
